dependencies:
  cache_directories:
    - "~/examples/data"
    - "~/examples/fsdata"
    - "~/mcr"
    - "~/spm12"
  override:
    - pip install --upgrade pip
    - pip install -e .
    - pip install matplotlib sphinx ipython
    - if [[ ! -d ~/examples/data ]]; then wget "http://tcpdiag.dl.sourceforge.net/project/nipy/nipype/nipype-0.2/nipype-tutorial.tar.bz2"; tar jxvf nipype-tutorial.tar.bz2; mkdir ~/examples; mv nipype-tutorial/* ~/examples/; fi
    - wget -O- http://neuro.debian.net/lists/trusty.us-nh.full | sudo tee /etc/apt/sources.list.d/neurodebian.sources.list
    - sudo apt-key adv --recv-keys --keyserver hkp://pgp.mit.edu:80 0xA5D32F012649A5A9
    - sudo apt-get update -y; sudo apt-get install -y fsl-core fsl-atlases fsl-feeds
    - bash ~/nipype/tools/install_spm_mcr.sh
test:
  override:
    - cd ~/examples && . /usr/share/fsl/5.0/etc/fslconf/fsl.sh && SPMMCRCMD="$HOME/spm12/run_spm12.sh $HOME/mcr/v85/ script" FORCE_SPMMCR=1 python ~/nipype/tools/run_examples.py fmri_spm_dartel Linear level1 l2pipeline
    - . /usr/share/fsl/5.0/etc/fslconf/fsl.sh && make html
    - cd ~/examples && . /usr/share/fsl/5.0/etc/fslconf/fsl.sh && SPMMCRCMD="$HOME/spm12/run_spm12.sh $HOME/mcr/v85/ script" FORCE_SPMMCR=1 python ~/nipype/tools/run_examples.py fmri_fsl_reuse Linear level1_workflow
    - cd ~/examples && . /usr/share/fsl/5.0/etc/fslconf/fsl.sh && SPMMCRCMD="$HOME/spm12/run_spm12.sh $HOME/mcr/v85/ script" FORCE_SPMMCR=1 python ~/nipype/tools/run_examples.py fmri_spm_nested Linear level1 l2pipeline

general:
  artifacts:
    - "doc/_build/html"
